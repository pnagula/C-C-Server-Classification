-- getting min and max of timestamp

select min(flow_start_ts), max(flow_start_ts)
from ipfix_stage2;

--"2018-05-19 23:27:16";"2018-06-03 00:07:28"

-- count of rows after elimiating duplicates

select count(*) from ipfix_stage2;

--228,768,5308

-- count of unique ips

select count(*) from network_traffic_behaviour_stats

-- 119,372,312

-- count of C&C and Normal traffic

select label,count(*) from network_traffic_behaviour_stats group by label;

-- 0;119372102
-- 1;      210

-- get model top 50 malicious IPs on decision_function (distance from separate hyperplane) descending order

select a.ip,b.decision_function
from  out_test a,cc_pred b
where a.id=b.id
and   b.prediction=1 and a.label=0
order by decision_function desc
limit 50;

--IP;Decision_function
--"36.110.220.15";61317560.9709586
--"203.205.151.204";60709310.7671936
--"103.1.138.196";60020673.6780866
--"119.29.29.29";53746039.2831812
--"39.135.17.36";53734897.2609848
--"47.91.203.234";53605118.0699322
--"203.205.129.101";53144303.7885414
--"203.205.151.160";52880185.7141146
--"64.111.199.222";52121255.3904245
--"121.6.170.15";51704625.6971261
--"173.241.248.220";50833336.4635665
--"93.184.216.34";50236901.4365113
--"45.113.192.101";48810164.3338179
--"95.211.106.173";48133298.1599573
--"95.211.106.24";47846055.7883753
--"8.37.239.4";47730515.151796
--"216.239.36.126";47259360.3764336
--"52.114.32.7";46822903.0384002
--"103.243.221.112";46396072.1647867
--"47.88.135.253";45873880.6053191
--"23.74.31.174";45579934.0399444
--"140.205.61.85";45479670.5955957
--"72.5.64.91";45311389.8440991
--"31.13.78.35";45276056.3690948
--"192.82.211.131";44916434.455193
--"116.15.2.247";44744780.6878957
--"182.254.116.116";44624685.9466019
--"119.74.52.162";44414475.1010133
--"151.101.76.84";44354823.4220821
--"216.146.43.71";44345104.2703381
--"204.79.197.200";44162084.4033661
--"98.136.146.33";43743191.256558
--"198.11.188.24";43606049.946799
--"106.10.249.25";43354763.0610387
--"103.20.94.1";43000613.2976592
--"176.74.182.158";42795979.0018771
--"23.74.228.201";42784064.4450647
--"131.186.113.135";42727205.3293898
--"198.11.189.91";42450004.7882552
--"36.51.254.228";42393733.1620156
--"123.58.100.31";42384095.8128623
--"8.42.96.133";42334460.732082
--"151.101.77.140";42273540.2782921
--"106.2.95.68";42228962.4970322
--"8.42.96.137";42074289.9338898
--"23.74.224.243";42007590.3369911
--"54.215.241.186";41922793.1366638
--"23.49.16.100";41613297.2712488
--"185.151.204.8";41542175.2764089
--"23.49.21.134";41301495.3108654



